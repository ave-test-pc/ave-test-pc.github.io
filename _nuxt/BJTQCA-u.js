import{g as e,qH as a,qI as l,hk as s,qJ as t,n as r,q as o,c as i,o as n,a as d,S as u,al as c,H as p,E as m,K as v,a4 as f,J as g,t as w,a1 as y,br as h,cZ as b,a3 as _,a2 as $,aw as k,F as C,aj as x,D as P,aS as V,cd as q,b as S,L as T,d as E,w as M,qx as R,N as z,c$ as D,bl as F,aP as A,a5 as I,T as L,ak as U,bk as j,aN as B,d5 as Z,_ as H}from"./C8zCCogY.js";import{s as J}from"./CWfe8Pzr.js";const N={primary:"icon-primary",success:"icon-success",warning:"icon-warning",error:"icon-error",info:"icon-info"},K={[N.primary]:a,[N.success]:t,[N.warning]:s,[N.error]:l,[N.info]:a};const G=y(r({name:"ElResult",__name:"result",props:e({title:{type:String,default:""},subTitle:{type:String,default:""},icon:{type:String,values:["primary","success","warning","info","error"],default:"info"}}),setup(e){const a=e,l=o("result"),s=m(()=>{const e=a.icon,l=e&&N[e]?N[e]:"icon-info";return{class:l,component:K[l]||K["icon-info"]}});return(a,t)=>(n(),i("div",{class:v(g(l).b())},[d("div",{class:v(g(l).e("icon"))},[c(a.$slots,"icon",{},()=>[s.value.component?(n(),p(f(s.value.component),{key:0,class:v(s.value.class)},null,8,["class"])):u("v-if",!0)])],2),e.title||a.$slots.title?(n(),i("div",{key:0,class:v(g(l).e("title"))},[c(a.$slots,"title",{},()=>[d("p",null,w(e.title),1)])],2)):u("v-if",!0),e.subTitle||a.$slots["sub-title"]?(n(),i("div",{key:1,class:v(g(l).e("subtitle"))},[c(a.$slots,"sub-title",{},()=>[d("p",null,w(e.subTitle),1)])],2)):u("v-if",!0),a.$slots.extra?(n(),i("div",{key:2,class:v(g(l).e("extra"))},[c(a.$slots,"extra")],2)):u("v-if",!0)],2))}})),O={key:1,class:"title2"},Q={key:3,class:"tip"},W=H(r({__name:"reset",props:{cType:{type:String,required:!0,validator:e=>["login","register","reset"].includes(e)}},emits:["update:c-type"],setup(e,{emit:a}){const l=a,s=e,t=h(),r=b(),{mode:o,lang:c}=_($()),{t:f}=k(),y=C(60),H=C(!1),N=C(!1),K=C(!1),W=C(!1),X=C(f("startForgetPassword")),Y=C(f("next")),ee=C(1),ae=C(),le=C(null),se=x({email:r.email,verificationCode:"",password:"",confirmPassword:""}),te=m(()=>({email:[{required:!0,message:f("startEmailRequiredMsg"),trigger:"blur"},{type:"email",message:f("startEmailError"),trigger:["blur","change"]}],verificationCode:[{required:!0,message:f("startVerificationCodeRequiredMsg"),trigger:"blur"}],password:[{required:!0,message:f("startPasswordRequiredMsg"),trigger:"blur"},{pattern:/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d)[A-Za-z\d@#$%^&*!]{8,20}$/,message:f("startPasswordError"),trigger:"blur"}],confirmPassword:[{required:!0,message:f("startConfirmPasswordRequiredMsg"),trigger:"blur"},{validator:oe,trigger:"blur"}]}));function re(){1===ee.value?l("update:c-type","login"):2===ee.value&&(ee.value=1,X.value=f("startForgetPassword"),Y.value=f("next"))}function oe(e,a,l){a!==se.password?l(new Error(f("startConfirmPasswordError"))):l()}function ie(){var e;null==(e=ae.value)||e.validate(e=>{e&&(1===ee.value?(Y.value=f("confirm"),de(),ee.value=2):2===ee.value?(K.value=!0,r.verifyRecoverCode({email:se.email,code:se.verificationCode}).then(()=>{r.updateEmailPassword({email:se.email,code:se.verificationCode,newPassword:J(se.password).toString()}).then(()=>{K.value=!1,Y.value=f("returnToLogin"),ee.value=3}).catch(e=>{B.error(String(e)),K.value=!1})}).catch(e=>{K.value=!1,B.error(String(e))})):l("update:c-type","login"))})}function ne(){N.value=!0,r.sendEmailCode({email:null==se?void 0:se.email,language:"zh-cn"==c.value||"zh-tw"==c.value?"cn":"en",emailType:"updatePassword"}).then(()=>{H.value=!0,W.value=!1,le.value=Z(()=>{y.value>0?y.value--:(clearInterval(le.value),le.value=null,N.value=!1,H.value=!1,y.value=60)},1e3)}).catch(e=>{B.error(String(e)),le.value||(N.value=!1),W.value=!1})}function de(){W.value=!0,ne()}return P([()=>r.email,()=>s.cType],e=>{"reset"===s.cType&&(se.email=r.email)}),P(()=>t.connectVisible,()=>{ee.value=1,X.value=f("startForgetPassword"),Y.value=f("next")}),V(()=>{}),q(()=>{le.value&&(clearInterval(le.value),le.value=null)}),(e,a)=>{const l=z,s=A,t=F,r=L,c=G,m=j;return n(),i("div",{class:v(["w-reset",g(o)])},[3!==g(ee)?(n(),i("h3",{key:0,class:"title",style:T({marginBottom:2===g(ee)?"40px":0})},[S(l,{size:28,style:{color:"var(--d-999-l-222)"},onClick:re},{default:M(()=>[S(g(R))]),_:1}),E(w(g(X)),1)],4)):u("",!0),2===g(ee)?(n(),i("h3",O,w(e.$t("startResetTitle2"))+"("+w(g(D)(g(se).email))+")",1)):u("",!0),S(m,{ref_key:"formRef",ref:ae,model:g(se),rules:g(te),"label-width":"0",autocomplete:"off",size:"large",style:T({marginTop:1===g(ee)?"40px":"10px"}),onSubmit:a[4]||(a[4]=U(()=>{},["prevent"]))},{default:M(()=>[1===g(ee)?(n(),p(t,{key:0,label:"",prop:"email"},{default:M(()=>[S(s,{modelValue:g(se).email,"onUpdate:modelValue":a[0]||(a[0]=e=>g(se).email=e),autocomplete:"new-email"+Math.random(),placeholder:e.$t("startEmail"),name:"emailField"},null,8,["modelValue","autocomplete","placeholder"])]),_:1})):2===g(ee)?(n(),i(I,{key:1},[S(t,{label:"",prop:"verificationCode"},{default:M(()=>[S(s,{modelValue:g(se).verificationCode,"onUpdate:modelValue":a[1]||(a[1]=e=>g(se).verificationCode=e),autocomplete:"new-verificationCode"+Math.random(),placeholder:e.$t("startVerificationCode"),name:"new-verificationCode"},{suffix:M(()=>[S(r,{class:"countdownBtn bg-transparent!",link:"",type:"primary",disabled:g(N),loading:g(W),onClick:de},{default:M(()=>[E(w(g(H)?`${g(y)}${e.$t("SS")}`:e.$t("startCountDown")),1)]),_:1},8,["disabled","loading"])]),_:1},8,["modelValue","autocomplete","placeholder"])]),_:1}),S(t,{label:"",prop:"password"},{default:M(()=>[S(s,{modelValue:g(se).password,"onUpdate:modelValue":a[2]||(a[2]=e=>g(se).password=e),type:"password",name:"password_field",autocomplete:"new-password"+Math.random(),placeholder:e.$t("startPassword"),"show-password":""},null,8,["modelValue","autocomplete","placeholder"])]),_:1}),S(t,{label:"",prop:"confirmPassword"},{default:M(()=>[S(s,{modelValue:g(se).confirmPassword,"onUpdate:modelValue":a[3]||(a[3]=e=>g(se).confirmPassword=e),type:"password",name:"confirm_password_field",placeholder:e.$t("startConfirmPassword"),autocomplete:"new-password2"+Math.random(),"show-password":""},null,8,["modelValue","placeholder","autocomplete"])]),_:1})],64)):(n(),p(c,{key:2,title:e.$t("startSuccessTitle")},{icon:M(()=>[...a[5]||(a[5]=[d("img",{src:"data:image/svg+xml,%3csvg%20width='60'%20height='60'%20viewBox='0%200%2060%2060'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='30'%20cy='30'%20r='30'%20fill='%2327AD75'%20fill-opacity='0.12'/%3e%3cpath%20d='M18.75%2030L26.25%2037.5L41.25%2022.5'%20stroke='%2327AD75'%20stroke-width='2.5'/%3e%3c/svg%3e",width:"80px"},null,-1)])]),_:1},8,["title"])),S(t,{class:v(["mb-0px!"])},{default:M(()=>[S(r,{type:"primary",class:"h-48px!",size:"large",loading:g(K),style:{width:"100%"},onClick:ie},{default:M(()=>[E(w(g(Y)),1)]),_:1},8,["loading"])]),_:1}),2===g(ee)?(n(),i("p",Q,"*Â "+w(e.$t("startResetTip")),1)):u("",!0)]),_:1},8,["model","rules","style"])],2)}}}),[["__scopeId","data-v-8c1524da"]]);export{W as default};
