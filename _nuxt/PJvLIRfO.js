import{a as e,E as a}from"./DHI12vUc.js";import{E as l}from"./D9paliCs.js";import{n as t,gg as i,aw as r,F as n,ap as o,c as s,o as d,a as u,M as c,b as f,w as m,a5 as p,a6 as v,J as b,E as g,H as x,t as h,d as T,ff as E,K as w,a8 as y,qp as C,at as N,aJ as S,S as I,qn as L}from"./C8zCCogY.js";import{E as _,a as j}from"./C-cIFx6x.js";import"./Dwz_iTym.js";import"./pAvqTbq1.js";import{S as D}from"./CW8dp4Yv.js";import"./Ch2kKm0h.js";import"./Q01_-I3Q.js";import"./jvqJ-lss.js";import"./2xvRo4QC.js";const z={class:"flex items-center justify-end gap-8px mb-16px"},Y={class:"flex items-center gap-4px text-12px"},P=["infinite-scroll-disabled"],V={class:"text-12px"},k={key:1},F={class:"mt-[2px] mb-[5px] py-[10px] text-[12px] text-center color-[--third-text]"},M={key:0},O=t({__name:"fundingRate",setup(t){const O=i(),{t:U}=r(),A=N([]),R=n({loading:!1,finished:!1,error:!1}),H=n(""),q=n({filterTypeList:"SETTLE_FUNDING_FEE",filterContractIdList:"ALL",filterStartCreatedTimeInclusive:o().subtract(7,"d").startOf("day").unix(),filterEndCreatedTimeExclusive:o().endOf("day").unix()}),J=g(()=>{var e,a,l;const t=(null==(l=null==(a=null==(e=O.metadata)?void 0:e.contractList)?void 0:a.reduce)?void 0:l.call(a,(e,a)=>(e[a.contractId]=a.contractName,e),{}))||{};return t.ALL=U("all"),t}),X=g(()=>{var e,a,l;const t=null==(l=null==(a=null==(e=O.metadata)?void 0:e.contractList)?void 0:a.map)?void 0:l.call(a,e=>({label:e.contractName,value:e.contractId}));return[{label:U("all"),value:"ALL"}].concat(t||[])}),$=e=>!!q.value.filterEndCreatedTimeExclusive&&o(e).isAfter(o(1e3*Number(q.value.filterEndCreatedTimeExclusive))),B=e=>!!q.value.filterStartCreatedTimeInclusive&&o(e).isBefore(o(1e3*Number(q.value.filterStartCreatedTimeInclusive))),G=async()=>{if(R.value.loading||R.value.finished)return;const e=Object.create(null);Object.keys(q.value).forEach(a=>{const l=q.value[a];l&&(["filterStartCreatedTimeInclusive","filterEndCreatedTimeExclusive"].includes(a)?e[a]=1e3*l:"ALL"!==l&&(e[a]=l))}),H.value&&(e.offsetData=H.value);try{R.value.loading=!0;const a=await L(e);let l=a.dataList||[];H.value&&(l=A.value.concat(l)),a.nextPageOffsetData||(R.value.finished=!0),H.value=a.nextPageOffsetData,A.value=l}catch(a){R.value.error=!0}finally{R.value.loading=!1}};G();const K=()=>{H.value="",A.value=[],R.value.finished=!1,R.value.error=!1,R.value.loading=!1,G()};return(t,i)=>{const r=e,n=a,g=l,N=S,L=_,O=j,Q=E;return d(),s(p,null,[u("div",z,[f(n,{modelValue:b(q).filterContractIdList,"onUpdate:modelValue":i[0]||(i[0]=e=>b(q).filterContractIdList=e),size:"small",class:"[&&]:[--el-select-width:110px]","popper-class":"[--el-font-size-base:12px]","suffix-icon":b(D),persistent:!1,onChange:K},{prefix:m(()=>[u("span",null,h(b(U)("markets1")),1)]),default:m(()=>[(d(!0),s(p,null,v(b(X),e=>(d(),x(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","suffix-icon"]),u("div",Y,[f(g,{modelValue:b(q).filterStartCreatedTimeInclusive,"onUpdate:modelValue":i[1]||(i[1]=e=>b(q).filterStartCreatedTimeInclusive=e),size:"small","disabled-date":$,class:"[--el-font-size-base:12px] [&&]:[--el-date-editor-width:120px]","range-separator":"To",format:"YYYY-MM-DD",placeholder:b(U)("startTime"),"value-format":"X",teleported:!1,clearable:!1,onChange:K},null,8,["modelValue","placeholder"]),T(" "+h(t.$t("to"))+" ",1),f(g,{modelValue:b(q).filterEndCreatedTimeExclusive,"onUpdate:modelValue":i[2]||(i[2]=e=>b(q).filterEndCreatedTimeExclusive=e),size:"small","disabled-date":B,class:"[--el-font-size-base:12px] [&&]:[--el-date-editor-width:120px]","range-separator":"To",format:"YYYY-MM-DD",placeholder:b(U)("endTime1"),"value-format":"X",teleported:!1,clearable:!1,onChange:K},null,8,["modelValue","placeholder"])])]),c((d(),s("div",{class:"relative min-h-400px bg-[--secondary-bg]","infinite-scroll-delay":200,"infinite-scroll-disabled":b(R).loading||b(R).finished||b(R).error,"infinite-scroll-immediate":!1,"infinite-scroll-distance":300},[f(O,{data:b(A),"header-row-class-name":"text-12px sticky top-0 z-10 font-500","cell-class-name":"color-[--main-text] text-12px"},{empty:m(()=>{var e;return[b(R).loading||0!==(null==(e=b(A))?void 0:e.length)?(d(),s("span",k)):(d(),x(N,{key:0,class:"pt-[40px]"},{default:m(()=>[u("span",V,h(t.$t("emptyNoData")),1)]),_:1}))]}),default:m(()=>[f(L,{label:b(U)("tradeTime"),prop:"fundingTime"},{default:m(({row:e})=>[T(h(b(o)(+e.fundingTime).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1},8,["label"]),f(L,{label:b(U)("markets1"),prop:"contractId"},{default:m(({row:e})=>[T(h(b(J)[e.contractId]),1)]),_:1},8,["label"]),f(L,{width:100,align:"right",label:b(U)("direction"),prop:"direction"},{default:m(({row:e})=>[u("span",{class:w(e.fundingPositionSize>0?"color-[--up-color]":"color-[--down-color]")},h(e.fundingPositionSize>0?b(U)("long"):b(U)("short")),3)]),_:1},8,["label"]),f(L,{align:"right",label:b(U)("contractSize"),prop:"contractSize"},{default:m(({row:e})=>{var a,l;return[T(h(("formatNumber"in t?t.formatNumber:b(y))(new(b(C))(e.fundingPositionSize).abs().toString()))+h(null==(l=null==(a=b(J)[e.contractId])?void 0:a.replace)?void 0:l.call(a,"USD","")),1)]}),_:1},8,["label"]),f(L,{align:"right",label:b(U)("fundingFee"),prop:"deltaFundingFee"},{default:m(({row:e})=>[T(h(("formatNumber"in t?t.formatNumber:b(y))(new(b(C))(e.deltaFundingFee).abs().toString()))+"USD ",1)]),_:1},8,["label"]),f(L,{align:"right",label:b(U)("fundingRate"),prop:"fundingRate"},{default:m(({row:e})=>[T(h(("formatNumber"in t?t.formatNumber:b(y))(100*Math.abs(e.fundingRate)))+"% ",1)]),_:1},8,["label"]),f(L,{align:"right",label:b(U)("oraclePrice"),prop:"fundingOraclePrice"},{default:m(({row:e})=>[T(h(("formatNumber"in t?t.formatNumber:b(y))(e.fundingOraclePrice,{limit:20,decimals:2})),1)]),_:1},8,["label"]),f(L,{align:"right",label:b(U)("indexPrice"),prop:"fundingIndexPrice"},{default:m(({row:e})=>[T(h(("formatNumber"in t?t.formatNumber:b(y))(e.fundingIndexPrice,{limit:20,decimals:2})),1)]),_:1},8,["label"])]),_:1},8,["data"]),u("div",F,[b(R).loading&&b(H)?(d(),s("span",M,h(b(U)("loading")),1)):I("",!0)])],8,P)),[[Q,G]])],64)}}});export{O as default};
