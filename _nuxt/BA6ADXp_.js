import{n as e,cC as l,br as t,av as a,bs as n,bt as o,bu as s,bv as i,a2 as u,a7 as r,c as d,o as c,M as p,S as v,b as m,H as x,aa as b,t as g,aP as f,R as y,J as h,E as w,aM as k,w as S,a as B,a5 as T,a6 as $,ak as _,K as V,F,bw as A,aL as q,bx as L,d as C,by as N,bz as M,bA as j,at as I,ac as E,a8 as P,aw as U,bB as G,c9 as Q,T as R,L as z,al as D,am as H,an as O,aU as W,cA as K,cL as J,dm as Y,dn as X,dp as Z,dq as ee,D as le,dr as te,ds as ae,dt as ne}from"./C8zCCogY.js";import{S as oe}from"./C535m_7q.js";import{u as se}from"./DNd1VKJp.js";import{r as ie,u as ue}from"./BWc5ynOe.js";const re={class:"items-center inline-flex"},de={key:0,class:"w-14px h-14px bg-[--secondary-text] rounded-full flex items-center justify-center mr-5px"},ce={key:1,class:"w-14px h-14px bg-[--secondary-text] rounded-full flex items-center justify-center mr-5px"},pe={key:2,class:"mr-5px color-[--secondary-text] text-12px"},ve=["src"],me={key:3,class:"ml-20px flex justify-end items-center text-12px"},xe={class:"color-[--secondary-text] mr-5px"},be={class:"flex items-center justify-between p-1px rounded-4px text-12px h-28px bg-[--main-input-button-bg] px-2px py-2px"},ge=["id","onClick","onMouseenter"],fe={class:"text-14px mt-4px mb-4px flex-start"},ye={class:"mr-4px color-[--third-text] text-14px"},he={key:0},we={key:1},ke={key:0,class:"text-14px mt-4px mb-4px flex-start"},Se={class:"mr-4px color-[--third-text] text-14px"},Be={key:1,class:"text-14px mt-4px mb-4px flex-start"},Te={class:"mr-4px color-[--third-text] text-14px whitespace-nowrap block"},$e={class:"whitespace-nowrap"},_e={class:"text-14px mt-4px mb-4px flex-start"},Ve={class:"mr-4px color-[--third-text] text-14px whitespace-nowrap"},Fe={class:"text-14px mt-4px mb-4px flex-start"},Ae={class:"mr-4px color-[--third-text] text-14px"},qe=e({__name:"quickSwapSet",props:{chain:{},quickBuyValue:{default:"0.01"},showQuickAmount:{type:Boolean},settingsButtonVisible:{type:Boolean,default:!0},quickTextVisible:{type:Boolean,default:!0}},emits:["update:quickBuyValue"],setup(e,{emit:U}){l();const G=t(),Q=a(),R=n(),z=o(),D=s(),H=i(),O=U,W=e,K=u(),J=I(0),Y=F(!1),X=F("s1"),Z=F({}),ee=F(null),le=w(()=>H.provider&&H.address&&!G.evmAddress),te=w(()=>W.chain&&G.isSupportChains.includes(W.chain)&&!le.value),ae=w(()=>W.settingsButtonVisible&&!le.value),ne=w(()=>{var e,l,t;const a=W.chain;if(!G.isSupportChains.includes(a))return"";const n=null==(t=null==(l=null==(e=z.botSettings)?void 0:e[a])?void 0:l.buy)?void 0:t[X.value],o=null==n?void 0:n.mev,{gasTip1List:s,gasTip2List:i}=N(R.gasTip,a),u=o?s:i,r=o?0:1,d=null==n?void 0:n.gas[r];return(null==d?void 0:d.customFee)||(null==u?void 0:u[null==d?void 0:d.level])}),se=w({get:()=>W.quickBuyValue,set(e){O("update:quickBuyValue",e)}});function ie(e){e&&(null==e?void 0:e.id)&&(Z.value[null==e?void 0:e.id]=e)}function ue(e){X.value=e,ee.value=Z.value[e]||null,Y.value=!0,function(){var e;const l=W.chain;if(!L(l))return;null==(e=j(l))||e.getFeeData().then(e=>{e&&(J.value=new M(e.gasPrice||0).toNumber())})}()}function qe(){var e,l,t,a,n,o,s,i,u;const r=W.chain;if(L(r)&&(null==(e=null==G?void 0:G.isSupportChains)?void 0:e.includes(r))){const e=null==(a=null==(t=null==(l=z.botSettings)?void 0:l[r])?void 0:t.buy)?void 0:a[X.value],d=null==e?void 0:e.mev,c=(null==(o=null==(n=R.mainTokensPrice)?void 0:n.find(e=>{var l;return e.chain===r&&e.token===(null==(l=E(r))?void 0:l.wmain_wrapper)}))?void 0:o.current_price_usd)||D.swap.native.price||0,{gasTip1List:p,gasTip2List:v}=N(R.gasTip,r),m=d?p:v,x=d?null==e?void 0:e.gas[0]:null==e?void 0:e.gas[1],b=(null==x?void 0:x.customFee)||(null==m?void 0:m[null==x?void 0:x.level])||"3",g=(null==(u=null==(i=null==(s=R.gasTip)?void 0:s.find)?void 0:i.call(s,e=>e.chain===r&&e.mev===!!d))?void 0:u.gasLimit)||2e5;return P(new M(J.value).plus(new M(b).times(String(10**9))).times(g).times(c).div(String(10**18)).toFixed(),2)}return 0}return(l,t)=>{var a;const n=b,o=f,s=q,i=r("tooltip");return c(),d("div",re,[e.quickTextVisible?(c(),d("span",de,[m(n,{class:"color-[--main-bg] text-10px",name:"mynaui:lightning-solid"})])):p((c(),d("span",ce,[m(n,{class:"color-[--main-bg] text-10px",name:"mynaui:lightning-solid"})])),[[i,l.$t("quick")]]),e.quickTextVisible?(c(),d("span",pe,g(l.$t("quick")),1)):v("",!0),m(o,{modelValue:h(se),"onUpdate:modelValue":t[0]||(t[0]=e=>k(se)?se.value=e:null),modelModifiers:{trim:!0},style:{"--el-input-text-color":"var(--main-text)","border-radius":"4px",width:"88px",height:"28px"},placeholder:"0",clearable:"",type:"text",onInput:t[1]||(t[1]=e=>{se.value=e.replace(/\-|[^\d.]/g,"")}),onBlur:t[2]||(t[2]=e=>function(e){var l,t,a;const n=e,o=(null==(a=null==(t=null==(l=new M(n||0))?void 0:l.toFixed)?void 0:t.call(l).match(new RegExp("[0-9]*(\\.[0-9]{0,4})?")))?void 0:a[0])||"";String(n)!==String(o)&&(""===n?se.value="":0===Number(o)?se.value="0":se.value=o)}(h(se))),onKeydown:t[3]||(t[3]=y(e=>{var l;return null==(l=null==e?void 0:e.target)?void 0:l.blur()},["enter"]))},{prefix:S(()=>[e.chain?(c(),d("img",{key:0,class:"rounded-full w-14px h-14px mr-4px!",src:`${h(Q).token_logo_url}chain/${e.chain}.png`,alt:"",onerror:"this.src='/icon-default.png'",srcset:""},null,8,ve)):v("",!0)]),_:1},8,["modelValue"]),h(te)&&h(ae)?(c(),d("div",me,[B("span",xe,g(l.$t("default")),1),B("div",be,[(c(!0),d(T,null,$("BotSettingsArr"in l?l.BotSettingsArr:h(A),l=>{var a,n,o;return c(),d("button",{id:l.value,key:l.value,ref_for:!0,ref:ie,class:V(["cursor-pointer border-none font-400 rounded-4px min-w-36px py-5px px-10px text-center",""+(l.value===(null==(o=null==(n=null==(a=h(z).botSettings)?void 0:a[e.chain])?void 0:n.buy)?void 0:o.selected)?"color-[--main-text] bg-[--tab-active-bg]":"color-[--secondary-text] bg-transparent")]),type:"button",onClick:_(t=>h(z).botSettings[e.chain].buy.selected=l.value,["stop"]),onMouseenter:e=>ue(l.value),onMouseleave:t[4]||(t[4]=e=>Y.value=!1)},g(l.label),43,ge)}),128))])])):v("",!0),h(te)?(c(),x(oe,{key:4,class:"ml-12px",chain:e.chain,setting:null==(a=h(z))?void 0:a.botSettings[e.chain],showQuickAmount:e.showQuickAmount},null,8,["chain","setting","showQuickAmount"])):v("",!0),m(s,{visible:h(Y),"onUpdate:visible":t[5]||(t[5]=e=>k(Y)?Y.value=e:null),"popper-class":"new-popover","virtual-ref":h(ee),"virtual-triggering":"",trigger:"contextmenu",placement:"bottom","popper-style":"min-width: auto; width: auto;",persistent:!1},{default:S(()=>{var t,a,o,s,u,r,x,b,f,y,w,k,S;return[B("ul",null,[B("li",fe,[p(m(n,{name:"custom:slippage",class:"text-14px color-[--third-text] ml-0 mr-6px cursor-pointer"},null,512),[[i,l.$t("slippage")]]),B("span",ye,g(l.$t("slippage")),1),"auto"!==(null==(s=null==(o=null==(a=null==(t=h(z).botSettings)?void 0:t[e.chain])?void 0:a.buy)?void 0:o[h(X)])?void 0:s.slippage)?(c(),d("span",he,g(null==(b=null==(x=null==(r=null==(u=h(z).botSettings)?void 0:u[e.chain||""])?void 0:r.buy)?void 0:x[h(X)])?void 0:b.slippage)+"%",1)):(c(),d("span",we,g(l.$t("auto")),1))]),h(L)(e.chain||"")?(c(),d("li",ke,[p(m(n,{name:"custom:gas",class:"text-14px color-[--third-text] ml-0 mr-6px cursor-pointer"},null,512),[[i,l.$t("estimatedGas")]]),B("span",Se,g(l.$t("estimatedGas")),1),C(" $"+g(qe()),1)])):v("",!0),"solana"===e.chain?(c(),d("li",Be,[p(m(n,{name:"custom:gas",class:"text-14px color-[--third-text] mr-6px cursor-pointer ml-0"},null,512),[[i,l.$t("priorityFee")]]),B("span",Te,g(l.$t("priorityFee")),1),B("span",$e,g(h(ne))+" SOL",1)])):v("",!0),B("li",_e,[p(m(n,{name:`custom:half-${h(K).mode}`,class:"text-18px color-[--third-text] ml-0 mr-6px cursor-pointer"},null,8,["name"]),[[i,l.$t("autoSellHalf")]]),B("span",Ve,g(l.$t("autoSellHalf")),1),C(" "+g((null==(f=h(z).autoSellConfigs)?void 0:f.autoSell)?l.$t("on"):l.$t("off")),1)]),B("li",Fe,[p(m(n,{name:"custom:mev",class:"text-16px color-[--third-text] ml-0 mr-6px cursor-pointer"},null,512),[[i,l.$t("mev")]]),B("span",Ae,g(l.$t("mev")),1),C(" "+g((null==(S=null==(k=null==(w=null==(y=h(z).botSettings)?void 0:y[e.chain])?void 0:w.buy)?void 0:k[h(X)])?void 0:S.mev)?l.$t("on"):l.$t("off")),1)])])]}),_:1},8,["visible","virtual-ref"])])}}}),Le={key:1,class:"ml-5px"},Ce={class:"text-20px"},Ne={class:"min-h-60px py-10px"},Me={class:"text-16px"},je={class:"flex mt-10px"},Ie=e({__name:"quickSwapButton",props:{quickBuyValue:{},row:{},appendTo:{default:"#__nuxt"},buttonBg:{default:"rgba(18, 184, 134, 0.15)"},mainNameVisible:{type:Boolean},classNames:{default:""},styles:{default:""}},emits:["submitSwap"],setup(e,{emit:l}){const{t:a}=U(),u=e,r=t(),p=I(!1),f=I(!1),y=I(""),w=G("noReminderQuickBuy",!1),{walletSwap:$,loadingWalletSwap:F}=se(),A=i(),q=l;function L(e){var l;if(e.stopPropagation(),q("submitSwap"),!J())return;if(p.value)return;if(new M(u.quickBuyValue||0).lte(0))return void Y({title:"Error",type:"error",message:a("amountMustG0")});const{row:t}=u;y.value=a("quickBuyMsg",{a:u.quickBuyValue,m:(null==(l=E(u.row.chain))?void 0:l.main_name)||"",s:t.symbol||(t.target_token==t.token0_address?t.token0_symbol:t.token1_symbol)}),w.value?oe():f.value=!0}const j=I(),P=o();async function oe(){var e;if(f.value=!1,A.provider&&A.address&&!r.evmAddress)return void async function(){const e=new M(u.quickBuyValue||0).toFixed();$(e,u.row)}();const{chain:l}=u.row;p.value=!0,await async function(e){var l,t,a,n;const o=r.getWalletAddress(e);if(!o)return;const s=null==(l=r.userInfo.addresses.find(l=>l.chain===e))?void 0:l.balance;let i={chain:e,token:X(e),address:X(e),decimals:null==(t=E(e))?void 0:t.decimals,symbol:null==(a=E(e))?void 0:a.main_name};if(s)return void(j.value={...i,balance:s});const u=await te({chain:e,tokens:[X(e)],walletAddress:o});i=(null==u?void 0:u[0])||{},j.value={...i,symbol:null==(n=E(e))?void 0:n.main_name,chain:e,address:i.token||i.address,decimals:i.decimals||i.decimal}}(l);const t=j.value,o=null==(e=new M(u.quickBuyValue||0).toFixed().match(new RegExp(`[0-9]*(\\.[0-9]{0,${(null==t?void 0:t.decimals)||18}})?`)))?void 0:e[0];return(Number(o)||0)<=0?(Y({title:"Error",type:"error",message:a("amountTooSmall")}),void(p.value=!1)):new M(o||0).gt((null==t?void 0:t.balance)||0)?(Y({title:"Error",type:"error",message:a("insufficientBalance")}),void(p.value=!1)):void async function(e){var l,t,o,s,i;const{chain:d}=u.row,c="solana"===d,{botSettings:v}=P,m=null==(t=null==(l=null==v?void 0:v[d])?void 0:l.buy)?void 0:t.selected,x=null==(s=null==(o=null==v?void 0:v[d])?void 0:o.buy)?void 0:s[m];if(c&&(null==x?void 0:x.mev)&&!(await r.getBundleAvailable()))return void(p.value=!1);const{gasTip1List:b,gasTip2List:g}=N(n().gasTip,"solana"),f=(null==x?void 0:x.mev)?b:g,y=(null==x?void 0:x.mev)?null==x?void 0:x.gas[0]:null==(i=null==x?void 0:x.gas)?void 0:i[1];let h={};if(c){let e=(null==y?void 0:y.customFee)||(null==f?void 0:f[null==y?void 0:y.level])||"0.002";(null==x?void 0:x.mev)&&new M(e).lt("0.002")&&(e="0.002"),h.priorityFee=new M(e).times(10**9).toFixed(0)}else{const e=0===Number(null==y?void 0:y.customFee)?"0":(null==y?void 0:y.customFee)||(null==f?void 0:f[null==y?void 0:y.level])||"3";h.gasTip=Number(new M(e).times(10**9).toFixed(0)),h.contractType=0,h.chain=d}const w=X(d),k=(null==x?void 0:x.slippage)||"9",S=r.getWalletAddress(d);if(!S)return;const B=Date.now().toString();h={...h,swapList:[{batchId:B,creatorAddress:S,inAmount:new M(e||0).times(10**j.value.decimals||0).toFixed(0)}],inTokenAddress:w,outTokenAddress:u.row.token||u.row.target_token,swapType:1,isPrivate:(null==x?void 0:x.mev)||!1,slippage:"auto"!==k?Number(new M(k).times(100).toFixed(0)):900,autoSell:P.autoSellConfig_autoSell||!1,autoSellConfig:null==P?void 0:P.selectedAutoSellConfig,autoGas:(null==y?void 0:y.customFee)?0:((null==y?void 0:y.level)||0)+1,autoSellGas:(null==y?void 0:y.customFee)?0:((null==y?void 0:y.level)||0)+1,autoSellPriorityFee:c?h.priorityFee:h.gasTip};let T=Z;c?T=ae:"ton"===d&&(T=ne);T(h).then(e=>function(e,l){var t;if(e){let n=setTimeout(()=>{re.placeOrderUpdate++,p.value=!1},500);const o=(null==(t=null==u?void 0:u.row)?void 0:t.chain)||"",s=(null==e?void 0:e[0])||{},i={solana:"/botapi/swap/createSolTx",ton:"/botapi/swap/createSwapTonTx"};ie({txInfo:s,chain:o,destination:(null==i?void 0:i[o])||"/botapi/swap/createSwapEvmTx",type:10});const r={[null==s?void 0:s.batchId]:null==s?void 0:s.id},d=le(()=>de.wsResult.tgbot,e=>{var t,o,s,i,u;const c=e.batchId;if(c===l){if(n&&(clearTimeout(n),n=null),re.placeOrderSuccess++,null==(o=null==(t=null==e?void 0:e.txList)?void 0:t[0])?void 0:o.success){Y({type:"success",message:a("tradeSuccess")});const l=null==(s=null==e?void 0:e.txList)?void 0:s[0];ue({...l,chain:null==e?void 0:e.chain},(null==r?void 0:r[c])||"")}else ee((null==(u=null==(i=null==e?void 0:e.txList)?void 0:i[0])?void 0:u.failMessage)||"swap error");d(),p.value=!1}})}}(e,B)).catch(e=>{ee(e||"swap error"),p.value=!1})}(o)}const re=s(),de=Q();return(l,t)=>{const a=b,n=R,o=W,s=K;return c(),d(T,null,[m(n,{disabled:!Number(e.quickBuyValue),loading:h(p)||h(F),color:e.buttonBg,class:V(["flex items-center [&&]:px-12px",e.classNames]),style:z([{"--el-button-hover-bg-color":"#12B886","--el-button-hover-text-color":"#FFF","--el-color-black":"#12B886","--el-button-border-color":"transparent","--el-button-hover-border-color":"transparent","--el-button-disabled-text-color":"#12B886","--el-button-disabled-border-color":"transparent","--el-button-disabled-bg-color":"#12B8861A"},e.styles]),onClick:L},{default:S(()=>[D(l.$slots,"default",H(O({loading:h(p)||h(F)})),()=>{var t;return[h(p)||h(F)?v("",!0):(c(),x(a,{key:0,class:"mr-4px",name:"mynaui:lightning-solid"})),C(" "+g(e.quickBuyValue||0)+" ",1),e.mainNameVisible?(c(),d("span",Le,g((null==(t=("getChainInfo"in l?l.getChainInfo:h(E))(e.row.chain))?void 0:t.main_name)||""),1)):v("",!0)]})]),_:3},8,["disabled","loading","color","class","style"]),h(f)?(c(),x(s,{key:0,modelValue:h(f),"onUpdate:modelValue":t[1]||(t[1]=e=>k(f)?f.value=e:null),title:l.$t("buy"),width:"400px","append-to":e.appendTo,"destroy-on-close":""},{header:S(()=>[B("span",Ce,g(l.$t("buy")),1)]),footer:S(()=>[m(n,{type:"primary",class:"w-full",size:"large",onClick:_(oe,["stop"])},{default:S(()=>[C(g(l.$t("confirm1")),1)]),_:1})]),default:S(()=>[B("div",Ne,[B("div",Me,g(h(y)),1),B("div",je,[m(o,{modelValue:h(w),"onUpdate:modelValue":t[0]||(t[0]=e=>k(w)?w.value=e:null),class:"[&&]:[--el-checkbox-text-color:--d-999-l-666]",label:l.$t("noAlert"),size:"large"},null,8,["modelValue","label"])])])]),_:1},8,["modelValue","title","append-to"])):v("",!0)],64)}}});export{qe as _,Ie as a};
